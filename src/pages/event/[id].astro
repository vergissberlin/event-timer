---
import Layout from '../../shared/Layout.astro';
import TimerScreen from '../../components/TimerScreen.astro';
import QrModal from '../../components/QrModal.astro';
import Footer from '../../components/Footer.astro';
import fs from 'node:fs';

export async function getStaticPaths() {
  try {
    const url = new URL('../../../public/data/events.json', import.meta.url);
    const file = await fs.promises.readFile(url, 'utf-8');
    const data = JSON.parse(file);
    const events = Array.isArray(data?.events) ? data.events : [];
    return events.map((e: { id: string }) => ({ params: { id: e.id } }));
  } catch {
    return [];
  }
}
const { id } = Astro.params;
---

<Layout title={`Event ${id}`}>
  <div id="app">
    <TimerScreen />
  </div>
  <QrModal />
  <Footer />
  <script type="module">
    import '/src/main.ts';
  </script>
</Layout>


